<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[혼공머신] 5주차 학습 내용 정리 | Halog</title>
<meta name=keywords content=","><meta name=description content="혼자 공부하는 머신러닝+딥러닝 5주차 학습 내용"><meta name=author content><link rel=canonical href=https://haservi.github.io/posts/books/hg-mldl/week-5/><meta name=google-site-verification content="G-MXZP81P04W"><link rel=stylesheet as=style crossorigin href=https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard.css><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://haservi.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://haservi.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://haservi.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://haservi.github.io/apple-touch-icon.png><link rel=mask-icon href=https://haservi.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ko href=https://haservi.github.io/posts/books/hg-mldl/week-5/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1400973749140762" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RP5NDCM8J9"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RP5NDCM8J9")}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://haservi.github.io/ accesskey=h title="Halog (Alt + H)">Halog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://haservi.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://haservi.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://haservi.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://haservi.github.io/>홈</a>&nbsp;»&nbsp;<a href=https://haservi.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[혼공머신] 5주차 학습 내용 정리</h1><div class=post-meta><span title='2025-08-10 16:31:15 +0900 +0900'>8월 10, 2025</span>&nbsp;·&nbsp;14 분</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>목차</span></summary><div class=inner><ul><li><a href=#%ea%b8%b0%eb%b3%b8-%ec%88%99%ec%a0%9c aria-label="기본 숙제">기본 숙제</a></li><li><a href=#%eb%82%b4%ec%9a%a9-%ec%a0%95%eb%a6%ac aria-label="내용 정리">내용 정리</a><ul><li><a href=#%ea%b5%b0%ec%a7%91-%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98 aria-label="군집 알고리즘">군집 알고리즘</a><ul><li><a href=#%ed%83%80%ea%b9%83%ec%9d%84-%eb%aa%a8%eb%a5%b4%eb%8a%94-%eb%b9%84%ec%a7%80%eb%8f%84-%ed%95%99%ec%8a%b5 aria-label="타깃을 모르는 비지도 학습">타깃을 모르는 비지도 학습</a></li><li><a href=#%ea%b3%bc%ec%9d%bc-%ec%82%ac%ec%a7%84-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%a4%80%eb%b9%84%ed%95%98%ea%b8%b0 aria-label="과일 사진 데이터 준비하기">과일 사진 데이터 준비하기</a></li><li><a href=#%ed%94%bd%ec%85%80%ea%b0%92-%eb%b6%84%ec%84%9d%ed%95%98%ea%b8%b0 aria-label="픽셀값 분석하기">픽셀값 분석하기</a></li><li><a href=#%ed%8f%89%ea%b7%a0%ea%b0%92%ea%b3%bc-%ea%b0%80%ea%b9%8c%ec%9a%b4-%ec%82%ac%ec%a7%84-%ea%b3%a0%eb%a5%b4%ea%b8%b0 aria-label="평균값과 가까운 사진 고르기">평균값과 가까운 사진 고르기</a></li></ul></li><li><a href=#k-%ed%8f%89%ea%b7%a0 aria-label=k-평균>k-평균</a><ul><li><a href=#kmeans-%ed%81%b4%eb%9e%98%ec%8a%a4 aria-label="KMeans 클래스">KMeans 클래스</a></li><li><a href=#%ed%81%b4%eb%9f%ac%ec%8a%a4%ed%84%b0-%ec%a4%91%ec%8b%ac aria-label="클러스터 중심">클러스터 중심</a></li><li><a href=#%ec%b5%9c%ec%a0%81%ec%9d%98-k-%ec%b0%be%ea%b8%b0 aria-label="최적의 k 찾기">최적의 k 찾기</a></li></ul></li><li><a href=#%ec%a3%bc%ec%84%b1%eb%b6%84-%eb%b6%84%ec%84%9d aria-label="주성분 분석">주성분 분석</a><ul><li><a href=#%ec%b0%a8%ec%9b%90%ea%b3%bc-%ec%b0%a8%ec%9b%90-%ec%b6%95%ec%86%8c aria-label="차원과 차원 축소">차원과 차원 축소</a></li><li><a href=#%ec%a3%bc%ec%84%b1%eb%b6%84-%eb%b6%84%ec%84%9d-%ec%86%8c%ea%b0%9c aria-label="주성분 분석 소개">주성분 분석 소개</a></li><li><a href=#pca-%ed%81%b4%eb%9e%98%ec%8a%a4 aria-label="PCA 클래스">PCA 클래스</a></li><li><a href=#%ec%9b%90%eb%b3%b8-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%9e%ac%ea%b5%ac%ec%84%b1 aria-label="원본 데이터 재구성">원본 데이터 재구성</a></li><li><a href=#%ec%84%a4%eb%aa%85%eb%90%9c-%eb%b6%84%ec%82%b0 aria-label="설명된 분산">설명된 분산</a></li><li><a href=#%eb%8b%a4%eb%a5%b8-%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%ea%b3%bc-%ed%95%a8%ea%bb%98-%ec%82%ac%ec%9a%a9%ed%95%98%ea%b8%b0 aria-label="다른 알고리즘과 함께 사용하기">다른 알고리즘과 함께 사용하기</a></li></ul></li></ul></li><li><a href=#%ec%b0%b8%ec%a1%b0 aria-label=참조>참조</a></li></ul></div></details></div><div class=post-content><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-01.webp></p><h2 id=기본-숙제>기본 숙제<a hidden class=anchor aria-hidden=true href=#기본-숙제>#</a></h2><p>k-평균 알고리즘 작동 방식 설명하기</p><p>k-평균 알고리즘은 데이터를 k개의 클러스터로 그룹화하는 비지도 학습 알고리즘입니다.</p><ol><li>초기 중심점 설정: k개의 클러스터 중심점(centroid)을 랜덤하게 배치합니다.</li><li>데이터 할당: 각 데이터 포인트를 가장 가까운 중심점의 클러스터에 할당합니다.</li><li>중심점 업데이트: 각 클러스터에 속한 데이터들의 평균 위치로 중심점을 이동시킵니다.</li><li>수렴까지 반복: 중심점이 더 이상 움직이지 않거나 변화가 미미할 때까지 2-3단계를 반복합니다.</li></ol><p>핵심 개념</p><ul><li>거리 측정: 주로 유클리드 거리를 사용하여 가장 가까운 중심점을 찾습니다</li><li>목표: 클러스터 내 분산을 최소화하고 클러스터 간 분산을 최대화</li><li>k값 선택: 적절한 클러스터 개수는 엘보우 방법이나 실루엣 분석으로 결정</li></ul><p>장점으로는 구현이 간단하고 빠르며, 구형 클러스터에 효과적입니다. 단점은 k값을 미리 정해야 하고, 초기값에 민감하며, 비구형 클러스터 처리에 한계가 있습니다.</p><h2 id=내용-정리>내용 정리<a hidden class=anchor aria-hidden=true href=#내용-정리>#</a></h2><p>이제 5주차와 6주차를 하면 블로그 내용 정리는 끝나는 것 같네요.</p><p>아직 챕터는 더 있는거 같은데.. 아마 내용이 많거나 실습이 어렵거나.. 어떠한 이유가 있을거라 생각되네요.</p><h3 id=군집-알고리즘>군집 알고리즘<a hidden class=anchor aria-hidden=true href=#군집-알고리즘>#</a></h3><p>고객이 올린 사진을 자동으로 분류하면 좋을 것 같은 이슈가 생겼네요. 타깃을 알지 못하는 상태에서 사진을 종류대로 모을 수 있는 방법에 대해 학습할 것 같습니다.</p><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-01.jpg></p><p>위 내용을 보니 몇년 전에 문득 봤던 이런 짤이 떠오르네요.</p><p>이제는 AI가 모든 분야에서 언급되고 있네요. 제조업에서는 품질 검사와 설비 관리, 의료 분야에서는 영상 진단, 농업에서도 작물 모니터링에 AI가 활용되고 있습니다.</p><p>요즘은 거의 모든 서비스가 &ldquo;AI 기반"이라는 수식어를 달고 나오는 느낌이네요.</p><h4 id=타깃을-모르는-비지도-학습>타깃을 모르는 비지도 학습<a hidden class=anchor aria-hidden=true href=#타깃을-모르는-비지도-학습>#</a></h4><p>위 처럼 타깃을 모르는 사진을 모르는 사진을 종류별로 분류하고 싶을 때 사용하는 머신러닝 알고리즘을 <strong>비지도 학습</strong> 이라고 합니다.</p><h4 id=과일-사진-데이터-준비하기>과일 사진 데이터 준비하기<a hidden class=anchor aria-hidden=true href=#과일-사진-데이터-준비하기>#</a></h4><p>이제는 코랩에 실제 이미지를 넣어서 작업을 하는 것 같습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=err>!</span><span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>bit</span><span class=o>.</span><span class=n>ly</span><span class=o>/</span><span class=n>fruits_300_data</span> <span class=o>-</span><span class=n>O</span> <span class=n>fruits_300</span><span class=o>.</span><span class=n>npy</span>
</span></span></code></pre></td></tr></table></div></div><p>위와 같이 입력하면 파일 탭에 <code>fruits_300.npy</code>로 저장된 것을 확인할 수 있습니다.</p><p><code>npy</code> 확장자가 생소해 찾아보니 아래와 같습니다.</p><p>NumPy 라이브러리에서 사용하는 바이너리 파일 형식입니다.</p><p>.npy 파일의 특징</p><ul><li>NumPy 배열(ndarray)을 효율적으로 저장하는 바이너리 형식</li><li>Python의 pickle보다 빠르고 안전함</li><li>배열의 shape, dtype, 데이터를 모두 보존</li><li>플랫폼 독립적 (endianness 처리)</li></ul><p>머신러닝 모델의 가중치 데이터를 저장하는데 쓰는 것 같아요.</p><p>간단하게 생각하면 개랑 고양이 동물 사진을 비교해야 하면 해당 이미지 데이터가 있는 파일이라고 보면 될 것 같아요.</p><p>각각의 이미지의 데이터(이미지 히스토그램 데이터 같은)를 저장하고 있는 데이터라고 보면 좋을 것 같아요.</p><p>결국 지금 실습에서는 과일의 이름은 모르지만 비슷하게 생긴 것을 분류하고 싶기 때문에 아래와 같이 과일 300개 npy 파일을 통해서 학습을 합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fruits</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;fruits_300.npy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>fruits</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=c1># (300, 100, 100)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=p>:])</span> <span class=c1># 첫 번째 이미지의 첫 번째 행 픽셀 100개의 값</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span>  <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>2</span>   <span class=mi>1</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>   <span class=mi>2</span>   <span class=mi>2</span>   <span class=mi>2</span>   <span class=mi>2</span>   <span class=mi>2</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>2</span>   <span class=mi>3</span>   <span class=mi>2</span>   <span class=mi>1</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>2</span>   <span class=mi>1</span>   <span class=mi>3</span>   <span class=mi>2</span>   <span class=mi>1</span>   <span class=mi>3</span>   <span class=mi>1</span>   <span class=mi>4</span>   <span class=mi>1</span>   <span class=mi>2</span>   <span class=mi>5</span>   <span class=mi>5</span>   <span class=mi>5</span>
</span></span><span class=line><span class=cl>  <span class=mi>19</span> <span class=mi>148</span> <span class=mi>192</span> <span class=mi>117</span>  <span class=mi>28</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>2</span>   <span class=mi>1</span>   <span class=mi>4</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>3</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>   <span class=mi>2</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span>   <span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p><code>numpy</code> 라이브러리를 통해 과일의 <code>shape</code> 함수를 호출하면 (300, 100, 100) 의 결과를 볼 수 있습니다.</p><p>첫번째 차원(300)은 샘플의 개수, 두 번째 차원(100)은 이미지 높이, 세 번째 차원(100)은 이미지 너비를 나타냅니다.</p><p>위에서 첫번째 과일 값을 출력하면 100개의 픽셀값을 확인할 수 있습니다. 이 값을 그림으로 표현하면 사과가 출력되는 것도 확인할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-02.webp></p><p>컴퓨터의 기준에서는 0을 기준으로 보는 것보다 255를 기준으로 보는게 출력값을 유의미하게 알 수 있습니다. 그렇기 때문에 흑백 이미지의 경우는 위와 같이 반전하여 사용합니다. 그런데 저렇게 있으면 사람이 판단하기 어렵기 때문에 <code>gray_r</code>을 지정하면 색상을 반전할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=mi>100</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=mi>200</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=mi>299</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-03.webp></p><p>용과 같은게 있네요. 어쨋든 위와 같이 <code>matplotlib.pyplot</code>의 <code>subplots()</code> 함수를 이용하면 조금 더 보기 좋게 배열처럼 볼 수 있습니다.</p><h4 id=픽셀값-분석하기>픽셀값 분석하기<a hidden class=anchor aria-hidden=true href=#픽셀값-분석하기>#</a></h4><p>아래 처럼 2,3 차원의 데이터를 합쳐서 픽셀값을 분석하기 편하게 바꿉니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>apple</span> <span class=o>=</span> <span class=n>fruits</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>100</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span> <span class=c1># 사과 100개에 대해 두 번째 차원과 세 번때 차원을 합침(10000)</span>
</span></span><span class=line><span class=cl><span class=n>pineapple</span> <span class=o>=</span> <span class=n>fruits</span><span class=p>[</span><span class=mi>100</span><span class=p>:</span><span class=mi>200</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>banana</span> <span class=o>=</span> <span class=n>fruits</span><span class=p>[</span><span class=mi>200</span><span class=p>:</span><span class=mi>300</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>apple</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=c1># 사과 배열 크기 (100, 10000)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>apple</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span> <span class=c1># 두 번째 축인 열을 따라 평균 계산</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span> <span class=mf>88.3346</span>  <span class=mf>97.9249</span>  <span class=mf>87.3709</span>  <span class=mf>98.3703</span>  <span class=mf>92.8705</span>  <span class=mf>82.6439</span>  <span class=mf>94.4244</span>  <span class=mf>95.5999</span>
</span></span><span class=line><span class=cl>  <span class=mf>90.681</span>   <span class=mf>81.6226</span>  <span class=mf>87.0578</span>  <span class=mf>95.0745</span>  <span class=mf>93.8416</span>  <span class=mf>87.017</span>   <span class=mf>97.5078</span>  <span class=mf>87.2019</span>
</span></span><span class=line><span class=cl>  <span class=mf>88.9827</span> <span class=mf>100.9158</span>  <span class=mf>92.7823</span> <span class=mf>100.9184</span> <span class=mf>104.9854</span>  <span class=mf>88.674</span>   <span class=mf>99.5643</span>  <span class=mf>97.2495</span>
</span></span><span class=line><span class=cl>  <span class=mf>94.1179</span>  <span class=mf>92.1935</span>  <span class=mf>95.1671</span>  <span class=mf>93.3322</span> <span class=mf>102.8967</span>  <span class=mf>94.6695</span>  <span class=mf>90.5285</span>  <span class=mf>89.0744</span>
</span></span><span class=line><span class=cl>  <span class=mf>97.7641</span>  <span class=mf>97.2938</span> <span class=mf>100.7564</span>  <span class=mf>90.5236</span> <span class=mf>100.2542</span>  <span class=mf>85.8452</span>  <span class=mf>96.4615</span>  <span class=mf>97.1492</span>
</span></span><span class=line><span class=cl>  <span class=mf>90.711</span>  <span class=mf>102.3193</span>  <span class=mf>87.1629</span>  <span class=mf>89.8751</span>  <span class=mf>86.7327</span>  <span class=mf>86.3991</span>  <span class=mf>95.2865</span>  <span class=mf>89.1709</span>
</span></span><span class=line><span class=cl>  <span class=mf>96.8163</span>  <span class=mf>91.6604</span>  <span class=mf>96.1065</span>  <span class=mf>99.6829</span>  <span class=mf>94.9718</span>  <span class=mf>87.4812</span>  <span class=mf>89.2596</span>  <span class=mf>89.5268</span>
</span></span><span class=line><span class=cl>  <span class=mf>93.799</span>   <span class=mf>97.3983</span>  <span class=mf>87.151</span>   <span class=mf>97.825</span>  <span class=mf>103.22</span>    <span class=mf>94.4239</span>  <span class=mf>83.6657</span>  <span class=mf>83.5159</span>
</span></span><span class=line><span class=cl> <span class=mf>102.8453</span>  <span class=mf>87.0379</span>  <span class=mf>91.2742</span> <span class=mf>100.4848</span>  <span class=mf>93.8388</span>  <span class=mf>90.8568</span>  <span class=mf>97.4616</span>  <span class=mf>97.5022</span>
</span></span><span class=line><span class=cl>  <span class=mf>82.446</span>   <span class=mf>87.1789</span>  <span class=mf>96.9206</span>  <span class=mf>90.3135</span>  <span class=mf>90.565</span>   <span class=mf>97.6538</span>  <span class=mf>98.0919</span>  <span class=mf>93.6252</span>
</span></span><span class=line><span class=cl>  <span class=mf>87.3867</span>  <span class=mf>84.7073</span>  <span class=mf>89.1135</span>  <span class=mf>86.7646</span>  <span class=mf>88.7301</span>  <span class=mf>86.643</span>   <span class=mf>96.7323</span>  <span class=mf>97.2604</span>
</span></span><span class=line><span class=cl>  <span class=mf>81.9424</span>  <span class=mf>87.1687</span>  <span class=mf>97.2066</span>  <span class=mf>83.4712</span>  <span class=mf>95.9781</span>  <span class=mf>91.8096</span>  <span class=mf>98.4086</span> <span class=mf>100.7823</span>
</span></span><span class=line><span class=cl> <span class=mf>101.556</span>  <span class=mf>100.7027</span>  <span class=mf>91.6098</span>  <span class=mf>88.8976</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>사과 샘플 100개에 대한 평균값을 계산했으며, 평균값이 어떻게 분포되는지 확인해봅니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>apple</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>pineapple</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>banana</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>([</span><span class=s1>&#39;apple&#39;</span><span class=p>,</span> <span class=s1>&#39;pineapple&#39;</span><span class=p>,</span> <span class=s1>&#39;banana&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-04.webp></p><p>이미지를 보면 바나나는 구분이 쉽지만, 사과와 파인애플은 영역(크기)도 비슷하기에 샘플의 평균값은 비슷하게 분포되는 것을 확인할 수 있습니다.</p><p>이를 해결하기 위해 각각의 픽셀에 대한 평균값으로 해결해 볼 수 있습니다. 아래와 같이 막대그래프 및 이미지로 비교해봅니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># subplots 함수를 사용하여 bar 그래프 생성(axis=0으로 지정하여 행에 대한 평균을 계산)</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>apple</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>pineapple</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>banana</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>apple_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>apple</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pineapple_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>pineapple</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>banana_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>banana</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>apple_mean</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>pineapple_mean</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>axs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>banana_mean</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-05.webp></p><p>위와 같이 픽셀 10,000개에 대한 평균값으로 사과, 파인애플, 바나나의 데이터가 표현하는 패턴이 차이가 있음을 확인할 수 있습니다.</p><h4 id=평균값과-가까운-사진-고르기>평균값과 가까운 사진 고르기<a hidden class=anchor aria-hidden=true href=#평균값과-가까운-사진-고르기>#</a></h4><p>사과, 파인애플, 바나나 중에 사과만 골라보는 실습을 합니다. <code>abs()</code> 함수를 이용해 이전에 가져온 사과 평균값을 비교합니다.</p><p>300개의 샘플 중에 이 오차가 가장 적은 100개를 선정하면 아래와 같이 모두 사과가 나온 것을 확인할 수 있습니다.</p><p>추가로 비슷한 방식으로 바나나, 파인애플도 가능할 것 같습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 바나나로 대체해보기</span>
</span></span><span class=line><span class=cl><span class=n>abs_diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>fruits</span> <span class=o>-</span> <span class=n>banana_mean</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>abs_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>abs_diff</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># print(abs_mean.shape)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>apple_index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>abs_mean</span><span class=p>)[:</span><span class=mi>100</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=n>apple_index</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=mi>10</span> <span class=o>+</span> <span class=n>j</span><span class=p>]],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 기존 사과 사진</span>
</span></span><span class=line><span class=cl><span class=n>abs_diff</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>fruits</span> <span class=o>-</span> <span class=n>apple_mean</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>abs_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>abs_diff</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># print(abs_mean.shape)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>apple_index</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>abs_mean</span><span class=p>)[:</span><span class=mi>100</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=n>apple_index</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=mi>10</span> <span class=o>+</span> <span class=n>j</span><span class=p>]],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-06.webp></p><p>사진을 보면 바나나의 경우는 마지막에 사과 비슷한게 몇개가 낀거 같네요. 추측해보자면 이전에 차트에서 바나나 중에 픽셀 값이 사과와 근접한게 있는데 이와 관련해서 평균값이 사과를 더 바나나 같다 생각하지 않을까 합니다.</p><p>실제로 바나나 기준으로 300개를 모두 나열 해보니 아래와 같이 바나나 2개가 정면샷과 후면샷을 찍은 걸 볼 수 있네요.</p><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-07.webp></p><p>이런 문제를 해결하기 위해서 바나나의 특징에 맞는 특성을 잘 맞춰 코드를 추가하거나 라벨링 데이터를 왕창 늘리면 좋지 않을까 생각(난 지금 찍먹중이니..)합니다.</p><p>위와 같이 비슷한 샘플끼리 그룹으로 모으는 작업을 <em>군집</em>이라고 합니다. 군집은 대표적인 비지도 학습 작업 중 하나이며, 군집 알고리즘에서 만든 그룹을 <em>클러스터</em>라고 부릅니다.</p><h3 id=k-평균>k-평균<a hidden class=anchor aria-hidden=true href=#k-평균>#</a></h3><p>1절에서는 각 픽셀의 평균값을 구하여 가장 가까운 사진을 골랐습니다. 이 경우는 이미 사진의 과일 항목을 알기 때문에 각 과일의 평균을 구할 수 있습니다. 하지만 진짜 비지도 학습에서는 사진에 어떤 과일이 들어 있는지 모릅니다.</p><p>이럴 경우 <code>k-평균</code> 군집 알고리즘이 평균값을 자동으로 찾아줍니다. 이 평균값이 클러스터의 중심에 위치하기 때문에 <code>클러스터 중심</code> 또는 <code>센트로이드</code>라고 부릅니다.</p><p>k-평균 알고리즘은 다음과 같은 작동 방식입니다.</p><ol><li>무작위로 k개의 클러스터 중심을 정합니다.</li><li>각 샘플에서 가장 ㄱ가까운 클러스터 중심을 찾아 해당 클러스터의 샘플로 지정합니다.</li><li>클러스터에 속한 샘플의 평균값으로 클러스터 중심을 변경합니다.</li><li>클러스터 중심에 변화가 없을 때까지 2번으로 돌아가 반복합니다.</li></ol><h4 id=kmeans-클래스>KMeans 클래스<a hidden class=anchor aria-hidden=true href=#kmeans-클래스>#</a></h4><p>사이킷런의 k-평균 알고리즘은 <code>sklearn.cluster</code> 모듈 아래 <code>KMeans</code> 클래스에 구현 돼 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fruits</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;fruits_300.npy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 3차원 배열을(샘플 개수, 너비 * 높이) 크기를 가진 2차원 배열로 변경</span>
</span></span><span class=line><span class=cl><span class=n>fruits_2d</span> <span class=o>=</span> <span class=n>fruits</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sklearn.cluster 모듈 아래 KMeans클래스로 사이킷런의 k-평균 알고리즘이 구현됨</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.cluster</span> <span class=kn>import</span> <span class=n>KMeans</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>km</span> <span class=o>=</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 비지도 학습이므로 fit() 메서드에서 타깃 데이터를 사용하지 않음</span>
</span></span><span class=line><span class=cl><span class=n>km</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>2</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>0</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span><span class=p>,</span> <span class=n>return_counts</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (array([0, 1, 2], dtype=int32), array([112,  98,  90]))</span>
</span></span></code></pre></td></tr></table></div></div><p>0,1,2 인덱스에 각각 112, 98, 90개의 이미지를 분류했네요.</p><p>모두 출력해보면 총 300개를 분류했지만 파인애플에 사과랑 바나나가 조금 섞여 있는 것을 확인할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>draw_fruits</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=n>ratio</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sampleCount</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 한 줄에 10개씩 이미지를 그리기 샘플 개수를 10으로 나누어 전체 행 개수를 계산합니다.</span>
</span></span><span class=line><span class=cl>    <span class=n>rows</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>ceil</span><span class=p>(</span><span class=n>sampleCount</span><span class=o>/</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># 행이 1개 이면 열 개수는 샘플 개수입니다. 그렇지 않으면 10개입니다.</span>
</span></span><span class=line><span class=cl>    <span class=n>cols</span> <span class=o>=</span> <span class=n>sampleCount</span> <span class=k>if</span> <span class=n>rows</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=k>else</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=n>squeeze</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rows</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>cols</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span><span class=o>*</span><span class=mi>10</span> <span class=o>+</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>sampleCount</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=mi>10</span> <span class=o>+</span> <span class=n>j</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray_r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>draw_fruits</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span><span class=o>==</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>draw_fruits</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span><span class=o>==</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>draw_fruits</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span><span class=o>==</span><span class=mi>2</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-08.webp></p><p>k-평균 알고리즘이 해당 샘플들을 완벽하게 구별해내지는 못했네요. 훈련 데이터에 타깃 레이블을 제공하지 않아도 어느 정도 비슷한 샘플을 모으는 것 같습니다.</p><h4 id=클러스터-중심>클러스터 중심<a hidden class=anchor aria-hidden=true href=#클러스터-중심>#</a></h4><p>KMeans 클래스가 최종적으로 찾은 클러스터 중심은 <code>cluster_center_</code> 속성에 저장 돼 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>draw_fruits</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>cluster_centers_</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span> <span class=n>ratio</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span> <span class=c1># 파인애플, 바나나, 사과</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 훈련 데이터 샘플에서 클러스터 중심까지 거리로 변환해 주는 transform 함수</span>
</span></span><span class=line><span class=cl><span class=c1># 특정 샘플(100번째)과 각 클러스터 중심점 간의 거리 계산</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>[</span><span class=mi>100</span><span class=p>:</span><span class=mi>101</span><span class=p>]))</span> <span class=c1># [[3400.24197319 8837.37750892 5279.33763699]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>[</span><span class=mi>100</span><span class=p>:</span><span class=mi>101</span><span class=p>]))</span> <span class=c1># 100번째 샘플이 어느 클러스터에 속하는지 예측</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>draw_fruits</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=mi>100</span><span class=p>:</span><span class=mi>101</span><span class=p>])</span> <span class=c1># 실제 100번째 과일 이미지를 표시</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>n_iter_</span><span class=p>)</span> <span class=c1># k-평균 알고리즘이 수렴하는데 걸린 반복 횟수 4번</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-09.webp></p><p>책에서는 2번째 인덱스를 파인애플이라 표기했지만 제가 실습할 때는 0번째 인덱스가 파인애플이라 표기됐네요.</p><p>k-평균 알고리즘은 반복적으로 클러스터 중심을 옮기면서 최적의 클러스터를 찾습니다. 해당 알고리즘이 반복한 횟수는 <code>n_iter_</code>에 저장되고 저는 4가 출력됐네요.</p><h4 id=최적의-k-찾기>최적의 k 찾기<a hidden class=anchor aria-hidden=true href=#최적의-k-찾기>#</a></h4><p>k-평균 알고리즘의 단점 중 하나는 클러스터 개수를 사전에 지정해야 한다는 점입니다.</p><p>군집 알고리즘에서 적절한 k 값을 찾기 위한 완벽한 방법은 없다고 합니다. 몇 가지 도구가 있지만 저마다 장단점이 있습니다.</p><p>해당 k 값을 찾기 위해 <code>엘보우</code> 방법에 대해 알아보겠습니다. 엘보우 방법은 클러스터 개수를 늘려가면서 이너셔(클래스터의 샘플이 얼마나 가깝게 있는지를 나타내는 값)의 변화를 관찰하여 최적의 클러스터 개수를 찾는 방법입니다.</p><p>클러스터 개수를 증가시키면서 이너셔를 그래프로 그리면 감소하는 속도가 꺽이는 지점이 있습니다.<br>이 지점부터는 클러스터 개수를 늘려도 클러스터에 잘 밀집된 정도가 크게 개선되지 않습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>inertia</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=c1># 2~5까지 k값을 바꿔가며 KMeans 클래스를 5번 훈련</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>km</span> <span class=o>=</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=n>k</span><span class=p>,</span> <span class=n>n_init</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>km</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>inertia</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>inertia_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>),</span> <span class=n>inertia</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;k&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;inertia&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-10.webp></p><p>그래프에서는 k값이 3일 때를 기준으로 이너셔의 값이 k가 증가해도 상대적으로 낮은 것을 확인할 수 있습니다.</p><p>위처럼 엘보우 지점보다 클러스터 개수가 많아지면 이너셔의 변화가 줄어들면서 군집 효과도 줄어듭니다.</p><p>하지만 위 그래프에서는 이런 지점이 명확하지 않다고 하네요. 혹시나 해서 2 ~ 80(더 늘리면 오래 걸림 이슈)까지 클러스터를 해봤는데도 사실 잘 모르겠네요.</p><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-11.webp></p><h3 id=주성분-분석>주성분 분석<a hidden class=anchor aria-hidden=true href=#주성분-분석>#</a></h3><p>너무 많은 사진이 등록되어 디스크 공간이 부족하여 이를 해결하기 위해 차원 축소에 대해 학습합니다.</p><h4 id=차원과-차원-축소>차원과 차원 축소<a hidden class=anchor aria-hidden=true href=#차원과-차원-축소>#</a></h4><p>데이터가 가진 속성을 특성이라고 부릅니다. 과일 사진의 경우 10,000개의 픽셀이 있기 때문에 10,000개의 특성이 있습니다.<br>머신러닝에서는 이런 특성을 <strong>차원</strong>이라고 부릅니다. 해당 차원을 줄일 수 있따면 저장 공간을 크게 절약할 수 있습니다.</p><p>이를 위해 <strong>차원축소</strong> 알고리즘을 다뤄봅니다. 차원 축소 알고리즘 중 대표적인게 <strong>주성분 분석(Principal Component Analysis)</strong> 입니다. <strong>PCA</strong>로 줄여부르기도 합니다.</p><h4 id=주성분-분석-소개>주성분 분석 소개<a hidden class=anchor aria-hidden=true href=#주성분-분석-소개>#</a></h4><p>주성분 분석(PCA, Principal Component Analysis)은 고차원 데이터를 저차원으로 축소하면서 데이터의 중요한 정보를 최대한 보존하는 기법입니다.</p><p>주여 특징은 다음과 같습니다.</p><ul><li>차원 축소: 고차원 → 저차원으로 변환하여 시각화와 계산 효율성 향상</li><li>정보 보존: 가장 중요한 정보를 우선적으로 보존</li><li>노이즈 제거: 중요하지 않은 성분을 제거하여 데이터 품질 향상</li><li>선형 변환: 원본 특성들의 선형 조합으로 새로운 축 생성</li></ul><p>주성분은 원본 차원과 같고 주성분으로 바꾼 데이터는 차원이 줄어들게 됩니다.</p><h4 id=pca-클래스>PCA 클래스<a hidden class=anchor aria-hidden=true href=#pca-클래스>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fruits</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;fruits_300.npy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fruits_2d</span> <span class=o>=</span> <span class=n>fruits</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PCA 클래스 사용</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.decomposition</span> <span class=kn>import</span> <span class=n>PCA</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 50개 주성분 정의</span>
</span></span><span class=line><span class=cl><span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pca</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>pca</span><span class=o>.</span><span class=n>components_</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=c1># (50, 10000)</span>
</span></span><span class=line><span class=cl><span class=c1># 50개의 주성분을 찾았으며, 두 번쨰 차원은 항상 원본 데이터의 특성 개수와 같음</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 50개의 주성분을 이미지로 시각화</span>
</span></span><span class=line><span class=cl><span class=n>draw_fruits</span><span class=p>(</span><span class=n>pca</span><span class=o>.</span><span class=n>components_</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-12.webp></p><p>위와 같이 주성분을 이미지로 시각화하면 가장 분산이 큰 방향을 순서대로 나타냅니다.</p><p>50개의 주성분을 찾은 PCA 모델을 사용해 기존 배열의 값을 변경합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>fruits_2d</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=c1># (300, 10000)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fruits_pca</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 주성분 50개로 교체</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>fruits_pca</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=c1># (300, 50)</span>
</span></span></code></pre></td></tr></table></div></div><p>이렇게 되면 10,000개의 크기에서 50개로 200배 정도 크기를 줄일 수 있습니다.</p><h4 id=원본-데이터-재구성>원본 데이터 재구성<a hidden class=anchor aria-hidden=true href=#원본-데이터-재구성>#</a></h4><p>PCA 클래스에는 원본 데이터를 복원할 수 있는 <code>inverse_transform</code> 메서드를 제공합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>fruits_inverse</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>(</span><span class=n>fruits_pca</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>fruits_inverse</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=c1># (300, 10000)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fruits_reconstruct</span> <span class=o>=</span> <span class=n>fruits_inverse</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>start</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>draw_fruits</span><span class=p>(</span><span class=n>fruits_reconstruct</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>start</span><span class=o>+</span><span class=mi>100</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-13.webp></p><p>50개의 특성이 분산을 가장 잘 보존하도록 변환된 것이기 때문에 어느 정도 이미지가 복원된 것을 확인할 수 있습니다.</p><h4 id=설명된-분산>설명된 분산<a hidden class=anchor aria-hidden=true href=#설명된-분산>#</a></h4><p>주성분이 원본 데이터의 분산을 얼마나 잘 나타내는지 기록한 값을 <em>설명된 분산</em>이라고 합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>pca</span><span class=o>.</span><span class=n>explained_variance_ratio_</span><span class=p>))</span> <span class=c1># 0.9213663445284296</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>pca</span><span class=o>.</span><span class=n>explained_variance_ratio_</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>92%가 넘는 분산을 유지하기 때문에 원본 데이터를 복원했을 때 원본 이미지의 품질이 높게 나올 수 있었습니다.</p><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-14.webp></p><h4 id=다른-알고리즘과-함께-사용하기>다른 알고리즘과 함께 사용하기<a hidden class=anchor aria-hidden=true href=#다른-알고리즘과-함께-사용하기>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.linear_model</span> <span class=kn>import</span> <span class=n>LogisticRegression</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>()</span>  <span class=c1># 로지스틱 회귀 분류기 생성</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 타겟 레이블 생성</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.model_selection</span> <span class=kn>import</span> <span class=n>cross_validate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 원본 데이터(10000차원)로 교차검증 - 정확도와 훈련시간 측정</span>
</span></span><span class=line><span class=cl><span class=n>scores</span> <span class=o>=</span> <span class=n>cross_validate</span><span class=p>(</span><span class=n>lr</span><span class=p>,</span> <span class=n>fruits_2d</span><span class=p>,</span> <span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;test_score&#39;</span><span class=p>]))</span>  <span class=c1># 평균 정확도: 0.9966666666666667 (99.67%)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;fit_time&#39;</span><span class=p>]))</span>    <span class=c1># 평균 훈련시간: 1.2789854049682616초</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PCA 적용된 데이터(50차원)로 교차검증 - 차원축소 효과 비교</span>
</span></span><span class=line><span class=cl><span class=n>scores</span> <span class=o>=</span> <span class=n>cross_validate</span><span class=p>(</span><span class=n>lr</span><span class=p>,</span> <span class=n>fruits_pca</span><span class=p>,</span> <span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;test_score&#39;</span><span class=p>]))</span>  <span class=c1># 평균 정확도: 0.9966666666666667 (동일한 성능)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;fit_time&#39;</span><span class=p>]))</span>    <span class=c1># 평균 훈련시간: 0.0359138011932373초 (더 빨리 훈련)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 분산 기준으로 PCA 적용 - 전체 분산의 50%를 보존하는 주성분 개수 자동 결정</span>
</span></span><span class=line><span class=cl><span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span> <span class=c1># 50% 분산 보존</span>
</span></span><span class=line><span class=cl><span class=n>pca</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>pca</span><span class=o>.</span><span class=n>n_components_</span><span class=p>)</span>  <span class=c1># 자동 결정된 주성분 개수: 2개 (50% 분산 보존에 2개면 충분)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2차원으로 극단적 축소</span>
</span></span><span class=line><span class=cl><span class=n>fruits_pca</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>fruits_2d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>fruits_pca</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>  <span class=c1># (300, 2) - 10000차원 → 2차원으로 5000배 축소</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2차원 데이터로 교차검증 - 극단적 차원축소의 성능 확인</span>
</span></span><span class=line><span class=cl><span class=n>scores</span> <span class=o>=</span> <span class=n>cross_validate</span><span class=p>(</span><span class=n>lr</span><span class=p>,</span> <span class=n>fruits_pca</span><span class=p>,</span> <span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;test_score&#39;</span><span class=p>]))</span>  <span class=c1># 평균 정확도: 0.99 (99%) - 약간 감소</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=s1>&#39;fit_time&#39;</span><span class=p>]))</span>    <span class=c1># 평균 훈련시간: 0.053063583374023435초</span>
</span></span></code></pre></td></tr></table></div></div><p>위와 같이 PCA로 축소한 데이터를 지도 학습에 적용해봤습니다. 로지스틱 회귀 모델을 이용하여 실습했으며, 차원을 극단적으로 줄여도 PCA로 만든 주성분을 이용하여 훈련 시간을 개선할 수 있다는 점을 배웠습니다.</p><p>실제 이미지 분류에서는 이전과 동일하게 파인애플에 사과와 바나나가 몇 개 들어가 있는 현상은 그대로네요.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.cluster</span> <span class=kn>import</span> <span class=n>KMeans</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>km</span> <span class=o>=</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>km</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>fruits_pca</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span><span class=p>,</span> <span class=n>return_counts</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span> <span class=c1># (array([0, 1, 2], dtype=int32), array([110,  99,  91]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>label</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>draw_fruits</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span> <span class=o>==</span> <span class=n>label</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>label</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>fruits_pca</span><span class=p>[</span><span class=n>km</span><span class=o>.</span><span class=n>labels_</span> <span class=o>==</span> <span class=n>label</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>data</span><span class=p>[:,</span><span class=mi>0</span><span class=p>],</span> <span class=n>data</span><span class=p>[:,</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>([</span><span class=s1>&#39;pineapple&#39;</span><span class=p>,</span> <span class=s1>&#39;banana&#39;</span><span class=p>,</span> <span class=s1>&#39;apple&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-15.webp></p><p><img alt=image loading=lazy src=/posts/books/hg-mldl/week-5/images/image-16.webp></p><p>그림을 보면 사과와 파인애플 클러스터의 경계가 모호한 점이 있어서 잘못 분류된게 아닐까 생각됩니다.</p><h2 id=참조>참조<a hidden class=anchor aria-hidden=true href=#참조>#</a></h2><ul><li>썸네일 출처: <a href=https://gigglehd.com/gg/bbs/6084685>https://gigglehd.com/gg/bbs/6084685</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://haservi.github.io/posts/books/hg-mldl/week-4/><span class=title>다음 페이지 »</span><br><span>[혼공머신] 4주차 학습 내용 정리</span></a></nav></footer><section class=comments><script>loadComment();function loadComment(){document.body.className.includes("dark")?theme="photon-dark":theme="boxy-light";let e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","haservi/haservi.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("theme",theme),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",""),document.querySelector("section.comments").innerHTML="",document.querySelector("section.comments").appendChild(e)}</script></section></article></main><footer class=footer><span>&copy; 2025 <a href=https://haservi.github.io/>Halog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:0,background:"#1d1e20",scrollOffset:40,container:null,template:null})})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")),loadComment()})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="복사";function s(){t.innerHTML="복사 완료!",setTimeout(()=>{t.innerHTML="복사"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>